{% load static %}

<!-- Sidebar Custom -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">

<!-- Script inline para aplicar estado antes de renderizar -->
<script>
(function() {
    var savedState = localStorage.getItem('sidebarState');
    if (savedState === 'collapsed') {
        document.documentElement.classList.add('sidebar-is-collapsed');
    }
})();
</script>

<div class="vet-sidebar" id="vetSidebar">
    <div class="vet-sidebar-header">
        <a href="{% url 'dashboard:dashboard' %}" class="vet-sidebar-logo">
            <img src="{% static 'img/logo.png' %}" alt="VetSantaSofia" height="40" />
        </a>
        <div class="vet-sidebar-toggle-container">
            <button class="vet-toggle-btn" id="sidebarToggleBtn" onclick="toggleVetSidebar()">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </div>

    <div class="vet-sidebar-wrapper">
        <div class="vet-sidebar-content">
            <ul class="vet-nav-menu">

                <!-- DASHBOARD -->
                <li class="vet-nav-item {% if request.resolver_match.namespace == 'dashboard' %}active{% endif %}">
                    <a href="{% url 'dashboard:dashboard' %}" class="vet-nav-link">
                        <i class="fas fa-home"></i>
                        <span>Dashboard</span>
                    </a>
                </li>

                <!-- CAJA -->
                <li class="vet-nav-item {% if request.resolver_match.namespace == 'caja' %}active{% endif %}">
                    <a href="{% url 'caja:cashregister' %}" class="vet-nav-link">
                        <i class="bi bi-bag-check-fill"></i>
                        <span>Caja</span>
                    </a>
                </li>

                <li class="vet-nav-section">
                   
                    <h4 class="vet-nav-section-title">CLINICA</h4>
                </li>

                <!-- AGENDA -->
                <li class="vet-nav-item {% if request.resolver_match.namespace == 'agenda' %}active{% endif %}">
                    <a href="{% url 'agenda:agenda' %}" class="vet-nav-link">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Agenda</span>
                    </a>
                </li>

                <!-- PACIENTES -->
                <li class="vet-nav-item {% if request.resolver_match.namespace == 'pacientes' %}active{% endif %}">
                    <a href="{% url 'pacientes:pacientes' %}" class="vet-nav-link">
                        <i class="fas fa-paw"></i>
                        <span>Pacientes</span>
                    </a>
                </li>

                <!-- INVENTARIO -->
                <li class="vet-nav-item {% if request.resolver_match.namespace == 'inventario' %}active{% endif %}">
                    <a href="{% url 'inventario:inventario' %}" class="vet-nav-link">
                        <i class="bi bi-box-seam"></i>
                        <span>Inventario</span>
                    </a>
                </li>

                <!-- SERVICIOS -->
                <li class="vet-nav-item {% if request.resolver_match.namespace == 'servicios' %}active{% endif %}">
                    <a href="{% url 'servicios:servicios' %}" class="vet-nav-link">
                        <i class="bi bi-prescription2"></i>
                        <span>Servicios</span>
                    </a>
                </li>

            </ul>
        </div>
    </div>
</div>

<!-- JavaScript Custom para Sidebar -->
<script>
function toggleVetSidebar() {
    const sidebar = document.getElementById('vetSidebar');
    const mainPanel = document.querySelector('.main-panel');
    const html = document.documentElement;
    
    if (sidebar.classList.contains('collapsed')) {
        sidebar.classList.remove('collapsed');
        if (mainPanel) mainPanel.classList.remove('sidebar-collapsed');
        html.classList.remove('sidebar-is-collapsed');
        localStorage.setItem('sidebarState', 'expanded');
    } else {
        sidebar.classList.add('collapsed');
        if (mainPanel) mainPanel.classList.add('sidebar-collapsed');
        html.classList.add('sidebar-is-collapsed');
        localStorage.setItem('sidebarState', 'collapsed');
    }
}

// Restaurar estado del sidebar cuando el DOM est√© listo
(function() {
    const sidebar = document.getElementById('vetSidebar');
    const mainPanel = document.querySelector('.main-panel');
    const savedState = localStorage.getItem('sidebarState');
    
    if (savedState === 'collapsed') {
        sidebar.classList.add('collapsed');
        if (mainPanel) {
            mainPanel.classList.add('sidebar-collapsed');
        }
    } else {
        sidebar.classList.remove('collapsed');
        if (mainPanel) {
            mainPanel.classList.remove('sidebar-collapsed');
        }
    }
})();
</script>
<!-- End Sidebar Custom -->